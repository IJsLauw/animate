{"version":3,"sources":["../../src/animate/Tween.js"],"names":["Tween","target","startProps","endProps","startFrame","duration","ease","endFrame","isTweenlessFrame","prop","hasOwnProperty","setPosition","currentFrame","setToEnd","time","lerp","props","setPropFromShorthand","lerpValue","start","end","t","x","y","sx","sy","kx","ky","r","lerpRotation","a","v","c","m","g","PI","Math","TWO_PI","difference","abs","value","transform","position","scale","skew","rotation","alpha","i","apply","visible","ma"],"mappings":"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","file":"Tween.js","sourcesContent":["/**\n * Provide timeline playback of movieclip\n * @memberof PIXI.animate\n * @class Tween\n * @constructor\n * @param {PIXI.animate.MovieClip} target The target to play\n * @param {Object} startProps The starting properties\n * @param {Object} endProps The ending properties\n * @param {int} duration Number oframes to tween\n * @param {Function} [ease] Ease function to use\n */\n\nclass Tween {\n\n    constructor(target, startProps, endProps, startFrame, duration, ease) {\n\n        /**\n         * target display object\n         * @name PIXI.animate.Tween#target\n         * @type {Object}\n         */\n        this.target = target;\n\n        /**\n         * properties at the start of the tween\n         * @type {Object}\n         * @name PIXI.animate.Tween#startProps\n         */\n        this.startProps = startProps;\n\n        /**\n         * properties at the end of the tween, as well as any properties that are set\n         * instead of tweened\n         * @type {Object}\n         * @name PIXI.animate.Tween#endProps\n         */\n        this.endProps = {};\n\n        /**\n         * duration of tween in frames. For a keyframe with no tweening, the duration will be 0.\n         * @type {int}\n         * @name PIXI.animate.Tween#duration\n         */\n        this.duration = duration;\n\n        /**\n         * The frame that the tween starts on\n         * @type {int}\n         * @name PIXI.animate.Tween#startFrame\n         */\n        this.startFrame = startFrame;\n\n        /**\n         * the frame that the tween ends on\n         * @type {int}\n         * @name PIXI.animate.Tween#endFrame\n         */\n        this.endFrame = startFrame + duration;\n\n        /**\n         * easing function to use, if any\n         * @type {Function}\n         * @name PIXI.animate.Tween#ease\n         */\n        this.ease = ease;\n\n        /**\n         * If we don't tween.\n         * @type {Boolean}\n         * @name PIXI.animate.Tween#isTweenlessFrame\n         */\n        this.isTweenlessFrame = !endProps;\n\n\n        let prop;\n        if (endProps) {\n            //make a copy to safely include any unchanged values from the start of the tween\n            for (prop in endProps) {\n                this.endProps[prop] = endProps[prop];\n            }\n        }\n\n        //copy in any starting properties don't change\n        for (prop in startProps) {\n            if (!this.endProps.hasOwnProperty(prop)) {\n                this.endProps[prop] = startProps[prop];\n            }\n        }\n    }\n\n    /**\n     * Set the current frame.\n     * @method PIXI.animate.Tween#setPosition\n     * @param {int} currentFrame\n     */\n    setPosition(currentFrame) {\n        //if this is a single frame with no tweening, or at the end of the tween, then\n        //just speed up the process by setting values\n        if (currentFrame >= this.endFrame) {\n            this.setToEnd();\n            return;\n        }\n\n        if (this.isTweenlessFrame) {\n            this.setToEnd();\n            return;\n        }\n\n        let time = (currentFrame - this.startFrame) / this.duration;\n        if (this.ease) {\n            time = this.ease(time);\n        }\n        let target = this.target;\n        let startProps = this.startProps;\n        let endProps = this.endProps;\n        for (let prop in endProps) {\n            let lerp = props[prop];\n            if (lerp) {\n                setPropFromShorthand(target, prop, lerp(startProps[prop], endProps[prop], time));\n            } else {\n                setPropFromShorthand(target, prop, startProps[prop]);\n            }\n        }\n    }\n\n    /**\n     * Set to the end position\n     * @method PIXI.animate.Tween#setToEnd\n     */\n    setToEnd() {\n        let endProps = this.endProps;\n        let target = this.target;\n        for (let prop in endProps) {\n            setPropFromShorthand(target, prop, endProps[prop]);\n        }\n    }\n}\n\n//standard tweening\nfunction lerpValue(start, end, t) {\n    return start + (end - start) * t;\n}\n\nconst props = {\n    //position\n    x: lerpValue,\n    y: lerpValue,\n    //scale\n    sx: lerpValue,\n    sy: lerpValue,\n    //skew\n    kx: lerpValue,\n    ky: lerpValue,\n    //rotation\n    r: lerpRotation,\n    //alpha\n    a: lerpValue,\n    //tinting\n    // t: lerpColor,\n    t: null,\n    //values to be set\n    v: null, //visible\n    c: null, //colorTransform\n    m: null, //mask\n    g: null //not sure if we'll actually handle graphics this way?\n};\n\n//split r, g, b into separate values for tweening\n/*function lerpColor(start, end, t)\n{\n    //split start color into components\n    let sR = start >> 16 & 0xFF;\n    let sG = start >> 8 & 0xFF;\n    let sB = start & 0xFF;\n    //split end color into components\n    let eR = end >> 16 & 0xFF;\n    let eG = end >> 8 & 0xFF;\n    let eB = end & 0xFF;\n    //lerp red\n    let r = sR + (eR - sR) * percent;\n    //clamp red to valid values\n    if (r < 0)\n        r = 0;\n    else if (r > 255)\n        r = 255;\n    //lerp green\n    let g = sG + (eG - sG) * percent;\n    //clamp green to valid values\n    if (g < 0)\n        g = 0;\n    else if (g > 255)\n        g = 255;\n    //lerp blue\n    let b = sB + (eB - sB) * percent;\n    //clamp blue to valid values\n    if (b < 0)\n        b = 0;\n    else if (b > 255)\n        b = 255;\n\n    let combined = (r << 16) | (g << 8) | b;\n    return combined;\n}*/\n\nconst PI = Math.PI;\nconst TWO_PI = PI * 2;\n\n//handle 355 -> 5 degrees only going through a 10 degree change instead of\n//the long way around\n//Math from http://stackoverflow.com/a/2708740\nfunction lerpRotation(start, end, t) {\n    let difference = Math.abs(end - start);\n    if (difference > PI) {\n        // We need to add on to one of the values.\n        if (end > start) {\n            // We'll add it on to start...\n            start += TWO_PI;\n        } else {\n            // Add it on to end.\n            end += PI + TWO_PI;\n        }\n    }\n\n    // Interpolate it.\n    let value = (start + ((end - start) * t));\n\n    // wrap to 0-2PI\n    /*if (value >= 0 && value <= TWO_PI)\n        return value;\n    return value % TWO_PI;*/\n\n    //just return, as it's faster\n    return value;\n}\n\nfunction setPropFromShorthand(target, prop, value) {\n    switch (prop) {\n        case \"x\":\n            target.transform.position.x = value;\n            break;\n        case \"y\":\n            target.transform.position.y = value;\n            break;\n        case \"sx\":\n            target.transform.scale.x = value;\n            break;\n        case \"sy\":\n            target.transform.scale.y = value;\n            break;\n        case \"kx\":\n            target.transform.skew.x = value;\n            break;\n        case \"ky\":\n            target.transform.skew.y = value;\n            break;\n        case \"r\":\n            target.transform.rotation = value;\n            break;\n        case \"a\":\n            target.alpha = value;\n            break;\n        case \"t\":\n            target.i(value); // i = setTint\n            break;\n        case \"c\":\n            target.c.apply(target, value); // c = setColorTransform\n            break;\n        case \"v\":\n            target.visible = value;\n            break;\n        case \"m\":\n            target.ma(value); // ma = setMask\n            break;\n    }\n}\n\n// Assign to namespace\nexport default Tween;"]}