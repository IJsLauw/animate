{"version":3,"sources":["../../src/animate/Timeline.js"],"names":["Timeline","target","Array","call","_currentProps","p","prototype","Object","create","addTween","properties","startFrame","duration","ease","extendLastFrame","startProps","prop","hasOwnProperty","startValue","getPropFromShorthand","i","length","endProps","tween","push","assign","addKeyframe","endFrame","prevTween","isTweenlessFrame","position","x","y","scale","skew","rotation","alpha","visible","mask"],"mappings":"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","file":"Timeline.js","sourcesContent":["import Tween from './Tween';\n\n/**\n * The Timeline class represents a\n * @memberof PIXI.animate\n * @class Timeline\n * @param {PIXI.DisplayObject} Target The target for this string of tweens.\n * @extends Array\n * @constructor\n */\nconst Timeline = function(target) {\n    Array.call(this);\n\n    /**\n     * The target DisplayObject.\n     * @name PIXI.animate.Timeline#target\n     * @type {PIXI.DisplayObject}\n     */\n    this.target = target;\n\n    /**\n     * Current properties in the tween, to make building the timeline more\n     * efficient.\n     * @name PIXI.animate.Timeline#_currentProps\n     * @type {Object}\n     * @private\n     */\n    this._currentProps = {};\n};\n\nconst p = Timeline.prototype = Object.create(Array.prototype);\n\n/**\n * Adds one or more tweens (or timelines) to this timeline. The tweens will be paused (to remove them from the normal ticking system)\n * and managed by this timeline. Adding a tween to multiple timelines will result in unexpected behaviour.\n * @method PIXI.animate.Timeline#addTween\n * @param tween The tween(s) to add. Accepts multiple arguments.\n * @return Tween The first tween that was passed in.\n */\np.addTween = function(properties, startFrame, duration, ease) {\n    this.extendLastFrame(startFrame - 1);\n    //ownership of startProps is passed to the new Tween - this object should not be reused\n    let startProps = {};\n    let prop;\n    //figure out what the starting values for this tween should be\n    for (prop in properties) {\n        //if we have already set that property in an earlier tween, use the ending value\n        if (this._currentProps.hasOwnProperty(prop)) {\n            startProps[prop] = this._currentProps[prop];\n        }\n        //otherwise, get the current value\n        else {\n            let startValue = startProps[prop] = this.getPropFromShorthand(prop);\n            //go through previous tweens to set the value so that when the timeline loops\n            //around, the values are set properly - having each tween know what came before\n            //allows us to set to a specific frame without running through the entire timeline\n            for (let i = this.length - 1; i >= 0; --i) {\n                this[i].startProps[prop] = startValue;\n                this[i].endProps[prop] = startValue;\n            }\n        }\n    }\n    //create the new Tween and add it to the list\n    let tween = new Tween(this.target, startProps, properties, startFrame, duration, ease);\n    this.push(tween);\n    //update starting values for the next tween - if tweened values included 'p', then Tween\n    //parsed that to add additional data that is required\n    Object.assign(this._currentProps, tween.endProps);\n};\n\n/**\n * Add a single keyframe that doesn't tween.\n * @method PIXI.animate.Timeline#addKeyframe\n * @param {Object} properties The properties to set.\n * @param {int} startFrame The starting frame index.\n */\np.addKeyframe = function(properties, startFrame) {\n    this.extendLastFrame(startFrame - 1);\n    let startProps = Object.assign({}, this._currentProps, properties);\n    //create the new Tween and add it to the list\n    let tween = new Tween(this.target, startProps, null, startFrame, 0);\n    this.push(tween);\n    Object.assign(this._currentProps, tween.endProps);\n};\n\n/**\n * Extend the last frame of the tween.\n * @method PIXI.animate.Timeline#extendLastFrame\n * @param {int} endFrame The ending frame index.\n */\np.extendLastFrame = function(endFrame) {\n    if (this.length) {\n        let prevTween = this[this.length - 1];\n        if (prevTween.endFrame < endFrame) {\n            if (prevTween.isTweenlessFrame) {\n                prevTween.endFrame = endFrame;\n            } else {\n                this.addKeyframe(\n                    this._currentProps,\n                    prevTween.endFrame + 1,\n                    endFrame - prevTween.endFrame + 1\n                );\n            }\n        }\n    }\n};\n\n/**\n * Get the value for a property\n * @method PIXI.animate.Timeline#getPropFromShorthand\n * @param {string} prop\n */\np.getPropFromShorthand = function(prop) {\n    const target = this.target;\n    switch (prop) {\n        case 'x':\n            return target.position.x;\n        case 'y':\n            return target.position.y;\n        case 'sx':\n            return target.scale.x;\n        case 'sy':\n            return target.scale.y;\n        case 'kx':\n            return target.skew.x;\n        case 'ky':\n            return target.skew.y;\n        case 'r':\n            return target.rotation;\n        case 'a':\n            return target.alpha;\n        case 'v':\n            return target.visible;\n        case 'm':\n            return target.mask;\n            // case 't':\n            //   return target.tint;\n            //not sure if we'll actually handle graphics this way?\n            //g: return null;\n    }\n    return null;\n};\n\n// Assign to namespace\nexport default Timeline;"]}